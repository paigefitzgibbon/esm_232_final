---
title: "ESM_232_SnowMelt_Model_Colon_Holmes"
author: "Mario Colon"
date: "June 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

###Library Load

```{r}

library(tidyverse)
library(deSolve)

```
###Load in data

```{r}

snow_inputs <- read_csv("Inputs.csv")

view(snow_inputs)

```

###Load three models

```{r}

source("model_1_warm.R")
source("model_2_ripe.R")
source("model_3_output.R")

```


###Data Wrangling

```{r}




```


##Model 1 - Warming Phase

```{r}

warm <- snow_warm(hm = snow_inputs$SWECM, Ts = snow_inputs$`snow surface temperatureC`, ci = 2101, pw = 1000, Tm = 0)

warm = as.data.frame(warm)

warm$time = c(seq(from = 1, to = 696))

warm
 

ggplot(warm, aes(time, warm)) + geom_point()


```


##Model 2 - Ripening Phase

```{r}


ripe <- snow_ripe(hs = snow_inputs$`snow depthCM`, theta_ret = 0.03, pw = 1000, lambda = 0.334)

ripe = as.data.frame(ripe)

ripe$time = c(seq(from = 1, to = 696))

ripe
 

ggplot(ripe, aes(time, ripe)) + geom_point()

```


##Model 3 - Output Phase 

```{r}


output <- snow_output(hm = snow_inputs$SWECM, hwret = 0.03, pw = 1000, lambda = 0.334)

output = as.data.frame(output)

output$time = c(seq(from = 1, to = 696))

output

ggplot(output, aes(time, output)) + geom_point()

```


##ODE

```{r}

swe_time_step = data.frame(time  = seq(from = 1, to = 696))

solar_compare = list(hm = 195.22, Ts = -9.13, ci = -2102, pw = 1000, Tm = 0)

solar_results = ode(solar_compare$Ts, swe_time_step$time, snow_warm, solar_compare)


```

